{
    "apiVersion": "apps/v1",
    "kind": "Deployment",
    "metadata": {
        "annotations": {
            "deployment.kubernetes.io/revision": "2",
            "meta.helm.sh/release-name": "sjp-service",
            "meta.helm.sh/release-namespace": "ns-dev-ccm-01"
        },
        "creationTimestamp": "2026-01-09T18:02:52Z",
        "generation": 8,
        "labels": {
            "app": "sjp",
            "app.kubernetes.io/instance": "sjp-service",
            "app.kubernetes.io/managed-by": "Helm",
            "app.kubernetes.io/name": "wildfly-app",
            "app.kubernetes.io/version": "291225",
            "context": "sjp",
            "helm.sh/chart": "wildfly-app-0.25.1",
            "istio-config/routing-mesh-internal-include": "true",
            "istio-policy": "core",
            "version": "26.1.3.Finaljdk17_291225_17.103.150-PEG-2848-SNAPSHOT"
        },
        "name": "sjp-service-wildfly-app",
        "namespace": "ns-dev-ccm-01",
        "resourceVersion": "2102451150",
        "uid": "60160862-d91c-4bf0-978b-dc9e89fc519d"
    },
    "spec": {
        "progressDeadlineSeconds": 600,
        "replicas": 1,
        "revisionHistoryLimit": 10,
        "selector": {
            "matchLabels": {
                "app": "sjp",
                "app.kubernetes.io/instance": "sjp-service",
                "app.kubernetes.io/name": "wildfly-app",
                "context": "sjp"
            }
        },
        "strategy": {
            "rollingUpdate": {
                "maxSurge": "25%",
                "maxUnavailable": 0
            },
            "type": "RollingUpdate"
        },
        "template": {
            "metadata": {
                "annotations": {
                    "checksum/standalonconf": "e10d4b47b4e30dca9bf1b0f8e266dd5366160742c8bd7ba9a6c62eb8e2a74a7d",
                    "checksum/standalonexml": "65e9c9715fa49c463702f9b174843e81faf28cb7f137c40e5adbe1c0951bee14",
                    "proxy.istio.io/config": "{ \"holdApplicationUntilProxyStarts\": true }"
                },
                "creationTimestamp": null,
                "labels": {
                    "app": "sjp",
                    "app.kubernetes.io/instance": "sjp-service",
                    "app.kubernetes.io/name": "wildfly-app",
                    "context": "sjp"
                }
            },
            "spec": {
                "containers": [
                    {
                        "env": [
                            {
                                "name": "LAUNCH_JBOSS_IN_BACKGROUND",
                                "value": "true"
                            },
                            {
                                "name": "DT_RELEASE_VERSION",
                                "value": "291225"
                            },
                            {
                                "name": "DT_RELEASE_BUILD_VERSION",
                                "value": "26.1.3.Finaljdk17_291225_17.103.150-PEG-2848-SNAPSHOT"
                            },
                            {
                                "name": "DT_RELEASE_PRODUCT",
                                "value": "wildfly-app-26.1.2.Final"
                            },
                            {
                                "name": "DT_RELEASE_STAGE",
                                "value": "ns-dev-ccm-01"
                            },
                            {
                                "name": "LANG",
                                "value": "en_GB.UTF-8"
                            },
                            {
                                "name": "LC_ALL",
                                "value": "en_GB.UTF-8"
                            },
                            {
                                "name": "DEBUG",
                                "value": "true"
                            }
                        ],
                        "envFrom": [
                            {
                                "secretRef": {
                                    "name": "sjp-service-wildfly-app-pg-secret"
                                }
                            }
                        ],
                        "image": "crmdvrepo01.azurecr.io/hmcts/sjp-service:26.1.3.Finaljdk17_291225_17.103.150-PEG-2848-SNAPSHOT",
                        "imagePullPolicy": "Always",
                        "lifecycle": {
                            "preStop": {
                                "exec": {
                                    "command": [
                                        "/bin/sh",
                                        "-c",
                                        "pkill java"
                                    ]
                                }
                            }
                        },
                        "livenessProbe": {
                            "failureThreshold": 100,
                            "httpGet": {
                                "httpHeaders": [
                                    {
                                        "name": "Host",
                                        "value": "api"
                                    }
                                ],
                                "path": "/sjp-service/internal/metrics/ping",
                                "port": "http",
                                "scheme": "HTTP"
                            },
                            "initialDelaySeconds": 150,
                            "periodSeconds": 3600,
                            "successThreshold": 1,
                            "timeoutSeconds": 15
                        },
                        "name": "wildfly-app",
                        "ports": [
                            {
                                "containerPort": 9080,
                                "name": "http",
                                "protocol": "TCP"
                            },
                            {
                                "containerPort": 9990,
                                "name": "tcp-jmx",
                                "protocol": "TCP"
                            },
                            {
                                "containerPort": 8787,
                                "name": "debug",
                                "protocol": "TCP"
                            }
                        ],
                        "readinessProbe": {
                            "failureThreshold": 30,
                            "httpGet": {
                                "httpHeaders": [
                                    {
                                        "name": "Host",
                                        "value": "api"
                                    }
                                ],
                                "path": "/sjp-service/internal/metrics/ping",
                                "port": "http",
                                "scheme": "HTTP"
                            },
                            "initialDelaySeconds": 60,
                            "periodSeconds": 3,
                            "successThreshold": 1,
                            "timeoutSeconds": 15
                        },
                        "resources": {
                            "limits": {
                                "cpu": "4",
                                "memory": "4Gi"
                            },
                            "requests": {
                                "cpu": "1200m",
                                "memory": "2Gi"
                            }
                        },
                        "securityContext": {
                            "runAsNonRoot": true,
                            "runAsUser": 1000
                        },
                        "terminationMessagePath": "/dev/termination-log",
                        "terminationMessagePolicy": "File",
                        "volumeMounts": [
                            {
                                "mountPath": "/opt/jboss/wildfly/standalone/configuration/standalone.xml",
                                "name": "wildfly-standalone-xml",
                                "subPath": "standalone.xml"
                            },
                            {
                                "mountPath": "/opt/jboss/wildfly/bin/standalone.conf",
                                "name": "wildfly-standalone-conf",
                                "subPath": "standalone.conf"
                            }
                        ]
                    }
                ],
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                    "agentpool": "wrkagentpool"
                },
                "restartPolicy": "Always",
                "schedulerName": "default-scheduler",
                "securityContext": {},
                "serviceAccount": "sjp-service-wildfly-app",
                "serviceAccountName": "sjp-service-wildfly-app",
                "terminationGracePeriodSeconds": 30,
                "volumes": [
                    {
                        "configMap": {
                            "defaultMode": 420,
                            "name": "sjp-service-wildfly-app-standalone.conf"
                        },
                        "name": "wildfly-standalone-conf"
                    },
                    {
                        "configMap": {
                            "defaultMode": 420,
                            "items": [
                                {
                                    "key": "standalone.xml",
                                    "path": "standalone.xml"
                                }
                            ],
                            "name": "sjp-service-wildfly-app-standalone.xml"
                        },
                        "name": "wildfly-standalone-xml"
                    }
                ]
            }
        }
    },
    "status": {
        "availableReplicas": 1,
        "conditions": [
            {
                "lastTransitionTime": "2026-01-09T18:02:52Z",
                "lastUpdateTime": "2026-01-15T11:38:18Z",
                "message": "ReplicaSet \"sjp-service-wildfly-app-7d8c4945\" has successfully progressed.",
                "reason": "NewReplicaSetAvailable",
                "status": "True",
                "type": "Progressing"
            },
            {
                "lastTransitionTime": "2026-01-16T17:19:00Z",
                "lastUpdateTime": "2026-01-16T17:19:00Z",
                "message": "Deployment has minimum availability.",
                "reason": "MinimumReplicasAvailable",
                "status": "True",
                "type": "Available"
            }
        ],
        "observedGeneration": 8,
        "readyReplicas": 1,
        "replicas": 1,
        "updatedReplicas": 1
    }
}
